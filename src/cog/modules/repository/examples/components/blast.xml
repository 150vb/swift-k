<?xml version="1.0"?>
<component xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <metadata version="1.0">
    <name>Blast</name>
    <author> Mihael </author>
	<shortdesc> Example File </shortdesc>
	<desc> BLAST demonstration for Bioinformatics </desc>
	<date_created>2005-08-10</date_created>
	<date_modified>2005-09-12</date_modified>
	<language>xml</language>
	<signature>k#kas1@hg$</signature>
  </metadata>
  <source>
  <![CDATA[
    <!--Conceptual Bioinformatics BLAST demostration-->
    <project>
	<include file="sys.xml"/>
	<include file="scheduler.xml"/>
	
	<element name="blast" arguments="host, input">
		<allocateHost name="host">
			<set names="inputfile, outputfile" annotation="Prepare">
				<uid context="input"/>
				<uid context="output"/>
			</set>
			<gridTransfer srchost="{host}" srcfile="{input}" desthost="{host}" destfile="{inputfile}"
				annotation="Get input"/>
			<gridExecute executable="blast" arguments="{inputfile} {outputfile}"
				annotation="Run Blast"/>
			<argument value="{host}"/>
			<argument value="{outputfile}"/>
		</allocateHost>
	</element>
	
	<element name="diff" arguments="host1, file1, host2, file2">
		<allocateHost name="host">
			<set names="inputfile1, inputfile2, outputfile" annotation="Prepare">
				<uid context="input1"/>
				<uid context="input2"/>
				<uid context="diffoutput"/>
			</set>
			<parallel>
				<gridTransfer srchost="{host1}" srcfile="{file1}" desthost="{host}" destfile="{inputfile1}"
					annotation="Get file1"/>
				<gridTransfer srchost="{host2}" srcfile="{file2}" desthost="{host}" destfile="{inputfile2}"
					annotation="Get file2"/>
			</parallel>
			<gridExecute executable="bdiff" arguments="{inputfile1} {inputfile2} {diffoutput}"
				annotation="Diff"/>
			<argument value="{host}"/>
			<argument value="{diffoutput}"/>
		</allocateHost>
	</element>
	
	<element name="get-output" arguments="host, file, destination">
		<gridTransfer srchost="{host}" srcfile="{file}" destdir="dataDir" destfile="{destination}"
			annotation="Get result"/>
	</element>
	
	<for name="input" from="1" to="1" parallel="true">
		<get-output host="{1}" file="{2}" destination="DIFF{input}.out">
			<diff host1="{1}" file1="{2}" host2="{3}" file2="{4}">
				<parallel>
					<blast host="localhost" input="dataDir/A{input}.in"/>
					<blast host="localhost" input="dataDir/B{input}.in"/>
				</parallel>
			</diff>
		</get-output>
	</for>
  </project>
  ]]>
  </source>
</component>
