<program xmlns="http://ci.uchicago.edu/swift/2009/02/swiftscript"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <types>
     	<type>
     		<typename>file</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
     	<type>
     		<typename>perlscript</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
  </types>
  <procedure name="do_sum" src="line 6">

    <output name="output" type="file"  xsi:nil="true"/>

    <input name="input" type="file"  xsi:nil="true"/>

    <input name="ps" type="perlscript"  xsi:nil="true"/>
    <binding>
      <application src="line 6">
        <executable>perl</executable>
        <stdout><function name="filename" src="line 8">
          <variableReference>output</variableReference></function></stdout><function name="filename" src="line 8">
          <variableReference>ps</variableReference></function><function name="filename" src="line 8">
          <variableReference>input</variableReference></function>  </application>
    </binding>
  </procedure>
  <variable name="sumall_pl" type="perlscript" isGlobal="false" src="line 4"><file name="sumall.pl"/></variable>
  <variable name="nFiles" type="int" isGlobal="false" xsi:nil="true" src="line 12"/>
  <assign src="line 13">
   <variableReference>nFiles</variableReference>
   <function name="toInt" src="line 12">
     <function name="arg" src="line 12">
       <stringConstant>nfiles</stringConstant><stringConstant>1000</stringConstant></function></function>
  </assign>
  <variable name="Indir" type="string" isGlobal="false" xsi:nil="true" src="line 13"/>
  <assign src="line 16">
   <variableReference>Indir</variableReference>
   <function name="arg" src="line 13">
     <stringConstant>Indir</stringConstant><stringConstant>./input/</stringConstant></function>
  </assign>
  <variable name="inputs" type="file[]" isGlobal="false" src="line 16">
    <mapping descriptor="filesys_mapper">
      <param name="location"><variableReference>Indir</variableReference></param>
      <param name="suffix"><stringConstant>.inp</stringConstant></param>
    </mapping>
  </variable>
  <variable name="outputs" type="file[]" isGlobal="false" src="line 17">
    <mapping descriptor="simple_mapper">
      <param name="location"><variableReference>Indir</variableReference></param>
      <param name="suffix"><stringConstant>.out</stringConstant></param>
    </mapping>
  </variable>
  <foreach var="input"  indexVar="i" src="line 19">
  <in><variableReference>inputs</variableReference></in>
  <body><call proc="do_sum" src="line 20">
      <output><arraySubscript>
       <variableReference>outputs</variableReference>
       <variableReference>i</variableReference>
      </arraySubscript></output>
      <input><variableReference>input</variableReference></input>
      <input><variableReference>sumall_pl</variableReference></input>
    </call></body>
  </foreach>
</program>
